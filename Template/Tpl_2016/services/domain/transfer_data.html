<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <title>域名注册域名申请国际域名国内域名cn域名注册-{companyname}</title>
    <meta name="description" content="{companyname}是国内著名的虚拟主机和域名注册提供商，名列全国10强。独创的第6代虚拟主机管理系统，拥有在线数据恢复、Isapi自定义，木马查杀等30余项领先功能.千M硬件防火墙,为您保驾护航！双线虚拟主机确保南北畅通无阻！">
    <meta name="keywords" content="虚拟主机,{companyname},域名注册,主机租用,主机,服务器租用,域名,网站空间,主机托管,双线虚拟主机,asp空间">
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
    <link rel="stylesheet" href="/template/Tpl_2016/css/global.css">
    <link rel="stylesheet" href="/template/Tpl_2016/css/common.css">
    <link rel="stylesheet" href="/template/Tpl_2016/css/domain.css">
    <link rel="stylesheet" href="/template/Tpl_2016/css/tp2016.css">
	  <link rel="stylesheet" href="/template/Tpl_2016/css/productDetailInfo.css">
  <link rel="stylesheet" href="/template/Tpl_2016/css/commonForm.css">
     <link rel="stylesheet" href="/jscripts/layui/css/layui.css">

	<script type="text/javascript" src="/template/Tpl_2016/jscripts/jquery-1.11.3.min.js"></script> 
	<script type="text/javascript" src="/jscripts/template.js"></script>
	<script type="text/javascript" src="/jscripts/audit/data.js"></script> 
	<script type="text/javascript" src="/jscripts/audit/pinyin.js"></script> 
    <script type="text/javascript" src="/jscripts/audit/config.js"></script>
	<script type="text/javascript" src="/jscripts/audit/domainbox.js?r=37145.31"></script>
	<script type="text/javascript" src="/jscripts/audit/domainaudit.js"></script>

</head>


<style>
#regdomain { background:url(/newimages/Domains/Domain_registration_bg_2.jpg) no-repeat; width:720px; overflow:hidden; margin:auto; padding:15px 15px 0px 15px; }
#regdomain form { display:block; margin:0; padding:0; }
#regdomain dl, #regdomain dt, #regdomain dd { display:block; margin:0; padding:0; clear:both; }
#regdomain dl { width:90%; margin:0 auto; margin-bottom:10px; }
#regdomain dt { background:url(/newimages/default/C_Title_ring_on.gif) center left no-repeat; padding-left:20px; font-size:14px; color:#000; font-weight:bold; height:35px; line-height:35px; }
#regdomain dd { color:#666; height:30px; line-height:30px; }
#regdomain label { display:block; float:left; width:120px; text-align:right; color:#333; font-weight:inherit; margin:0; padding:0; }
#regdomain h1, #regdomain h2, #regdomain h3 { display:block; float:left; font-size:12px; color:#999; font-weight:normal; margin:0; padding:0; }
#regdomain h1 { width:240px; }
#regdomain h2 { width:265px; clear:right; }
#regdomain p { width:90%; display:block; clear:both; text-align:center; margin:10px auto; padding:0; }
/* 鼠标移动时产生的样式*/
#regdomain input.oldbg { border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: #999; border-right-color: #f1f1f1; border-bottom-color: #f1f1f1; border-left-color: #CCC; height:14px; color:#666; }
#regdomain input.chgbg { border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: #35CDFF; border-right-color: #B3ECFF; border-bottom-color: #B3ECFF; border-left-color: #35CDFF; height:14px; color:#666; background-color: #E9F6FF; }
#regdomain dd select.oldbg { border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: #999; border-right-color: #f1f1f1; border-bottom-color: #f1f1f1; border-left-color: #CCC; height:18px; color:#666; }
#regdomain dd select.chgbg { border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: #35CDFF; border-right-color: #B3ECFF; border-bottom-color: #B3ECFF; border-left-color: #35CDFF; height:18px; color:#666; }
/*域名列表样式*/
.domaincontent { height:auto; }
#regdomain .domaincontent label { height:90px; background:url(/newimages/Domains/gowuchebg.gif) no-repeat; background-position:20px 1px; }
#regdomain .domaincontent h3 { width:500px; }
#regdomain dd h3 ul { display:block; list-style-type:none; margin:0; padding:0; }
#regdomainmsg { display:block; margin-bottom:15px; margin-top:15px; }
#regdomainmsg li { height:25px; line-height:25px; background:url(/newimages/Domains/domainquery_bg01.gif); }
.domaintitle { background:url(/newimages/default/assess_icon.gif) left no-repeat; padding-left:10px; padding-right:5px; display:block; float:left; background:#fff; width:auto; color:#000; }
.domainmsg { display:block; float:right; background:#fff; width:auto; }
#regdomain .clearbottom { clear:both; }
/*出错时出现的提示*/
#regdomain dl dd h2 span { margin:0; padding:0; display:none; height:25px; }
.Domain_Title { background:url(/newimages/default/C_Title_ring_on.gif) no-repeat 0px 10px; padding-left:20px; font-size:14px; color:#000; font-weight:bold; height:35px; line-height:35px; margin-top:20px; }
.Domain_Info_Content ul li { float:left; }
.ttl_ { height:24px; width:125px; text-align:right; color:#369; font-weight:bold; }
.iil_ { margin-left:15px; width:215px; height:24px; }
.rrl_ { margin-left:15px; height:24px; width:250px; }
.domainprice_d{ width:100px; display:block; float:left; padding-left:10px;}
.domainprice_c{ width:120px; display:block; float:left; padding-left:10px;}

</style>
 
 

</head>
<body class="min990">
{#top.html}


 <div class="content" id="content">
	 <div class="wide1190">
	 <br /> 
	<div id="SiteMapPath">
		<ul>
		  <li><a href="/">{companyname}首页</a></li>
		  <li><a href="/services/domain/">域名转入</a></li>
		</ul>
	</div>
 


 
 

 <form id="formtrans" name="formtrans" class="layui-form"  style="background-color:#fff;padding:15px;">

	<table  cellspacing="0" cellpadding="0" border="0" class="layui-table" lay-skin="line" >
			<thead>
			<tr class="vstitle">
				<th width="40">序号</th>
				<th width="150">域名</th>
				<th width="100">转入价格</th>
				<th width="100">域名类型</th>
				<th width="80">状态</th>
				<th>处理结果</th>
			</tr>
			</thead>
			<tbody>
			<!-- BEGIN dnamelistzr --> 
			<tr class="domitem" punycode="{dname}" authcode="" proid="domcn" needtry="1">
				<td>{bh}
					<input type="hidden" data-state="{bh}" name="mc_hashcode" value="{dname}" data-mcsysid="{bh}" data-mcproid="domcn" data-mcprokey="{dname}" data-mcprice="{dnamejg}" data-mcdotype="obtain">
				</td>
				<td>
					<div class="dom_name">{dname}</div>
				</td>
				<td><span id="price_1" class="price pricespan" data-price="{dnamejg}">{dnamejg}</span>元</td>
				<td>domcn</td>
				<td tag="status">---</td>
				<td tag="message" class="result">---</td>
			</tr>
			 <!-- END dnamelistzr --> 
			
		</tbody></table>



			<div id="mouldlistbox">
				<i class="layui-icon layui-icon-loading" style="font-size: 30px; color: #1E9FFF;"></i>  												
			</div> 
			<div class="pt-10">				
				<input type="checkbox" value="1" name="chgdns" title="转入成功后自动修改为西部数码的DNS进行域名解析(推荐)" lay-skin="primary"  />					
				 		
			</div>
			<hr  style="margin:10px 0;">
			<table width="100%">
				<tr>					
					<td align=left>
						<span style="font-size:16px; font-weight:bold;">总价:</span> <span class="mc_allprice" style="font-size:16px; font-weight:bold; color:red"  data-price="{sumprice}" id="allprice">{sumprice}元&nbsp;&nbsp;</span>
					 
					</td>
					<td></td>
				</tr>
			</table>
			<hr  style="margin:10px 0;">
			<div class="layui-btn-container">		
				<button name="transsubbtn" class="layui-btn  layui-btn-lg layui-btn-normal" lay-submit lay-filter="transsubbtn">确认提交</button> 
				<button name="btnresubmit" type="button" class="layui-btn  layui-btn-lg layui-btn-primary" lay-filter="btnresubmit" onclick="subneedtry()">返回重提交失败的</button>
			</div>
			<input type="hidden" name="mc_setcodeid" />
</form>

  <form name="frmresubmit" id="frmresubmit"></form>	
<script type="text/javascript">
		 
			var formtrans=$("form[name='formtrans']"); 
			var itemobjs,Dg3722,intok,intbad,opt_chgdns,opt_mbid,opt_hkfree,mc_setcodeid;
			$(function(){
				//模板相关
				layui.use(['form','laydate','laypage','layer','table','upload'], function(){			
					layform = layui.form;
					laypage = layui.laypage;
					laydate = layui.laydate;
					layer=layui.layer;
					laytable = layui.table;    
					layupload=layui.upload;					 
											
					var domainlist="{dname}".split(",").join("\r\n");						
					domainaudit.auto_init(formtrans,domainlist,function(){											
						formtrans.find("#mouldlistbox").html(this);
						layform.on("submit(transsubbtn)",function(obj){
							transsub.call(obj,domainlist);
							return false;
						});
					});
						
				});
			});			
			var transsub=function(obj,domainlist){
				var subbtn=$(obj.elem);
				if(!/[\w\.]+/ig.test(domainlist)){
					layer.error("转入的域名格式不正确");
					return false;
				}
				domainaudit.getdomaintype.call(formtrans);
				if(!domainaudit.chkregsub.call(formtrans)) return false;
				layer.sure("确定转入这些域名吗？",function(index_){
					subbtn.prop("disabled",false);
					layer.close(index_);
					 
					subbtn.prop("disabled",true);					
					domainaudit.getauditmould.call(formtrans,function(jsondata){
						opt_mbid=jsondata.c_sysid;								
						itemobjs = $(".domitem");					
						Dg3722 = $.dialog({title:false,esc:false,id:'Load3722'});
						intok=0;
						intbad=0;
						opt_chgdns = document.formtrans.chgdns.checked ? 1 : 0;  
						console.log(itemobjs)
						diguisub(0);
					});						
                 
				});	
			}               
			//------------------------------------------------------
            /*$("#formtrans").submit(function(){
                var _this = $(this);            
				$.dialog.confirm("确定转入这些域名吗？",function(){
                    var box=$.loadbox();
                    $.moneyCodeObj().action({loadbox:box,callback:function(){
                        box.close();
                        itemobjs = $(".domitem");
                        _this.find(":submit").attr("disabled",true);
                        Dg3722 = $.dialog({title:false,esc:false,id:'Load3722'});
                        intok=0;
                        intbad=0;
                        opt_chgdns = document.formtrans.chgdns.checked ? 1 : 0;
                        opt_hkfree = document.formtrans.hkfree.value;
                        mc_setcodeid=$("input[name='mc_setcodeid']:hidden").val();
                        diguisub(0);
                    }})
                })
                return false;
			}).find(":submit").attr("disabled",false);
			*/
            function focussub(icur){
                var cur = icur-1;
                var obj = itemobjs.eq(cur);

                var punycode=obj.attr("punycode");
                var authcode=obj.attr("authcode")
				
                var strdata = "act=sub&1=" + urlencode(punycode) + "&2="+opt_mbid + "&3=" + opt_chgdns  /// + "&2=" + urlencode(authcode) + "&3=" + opt_chgdns + "&4=" + opt_mbid + "&5=" + urlencode(opt_hkfree)+"&6="+ escape(mc_setcodeid) + "&7=focus";
			
                var box_status=obj.find("td[tag=status]");
                var box_message=obj.find("td[tag=message]");
                box_status.html("处理中...");
                box_message.html("处理中...");
                intbad--;

                $.ajax({type:'POST',url: window.location.pathname,data: strdata,error:function(xhr,txtstatus){ if(xhr.readyState!=0){
                    alert(xhr.responseText + "<br><font color=red>系统网络错误请联系管理员，点击确定继续</font>",function(){
                        box_status.html("失败");
                        box_message.html("系统网络错误 500");
                    })
                }},success : function(xml){
                    
                        var J = JSON.parse( xml);
                        if(J.result=="200"){
                            intok ++;
                            J.result = "<span class='bgreen'>成功</span>";
                            obj.attr("needtry","");
                        }else{
                            intbad ++;
                            J.result = "<span class='bred'>失败</span>";
                        }
                        box_status.html(J.result);
                        box_message.html(J.msg);
                        if(J.msg.indexOf('<focusbutton/>')>-1){
                            box_message.append("<input type='button' onclick='' value='强制转移'>");
                        }
                    
                },complete:function(obj){obj=null},
				error:function(a,b,c){
					  alert(xml,function(){
                            box_status.html("失败");
                            box_message.html("系统繁忙 1001");
                        })
				}
                })
            }
            function diguisub(cur){
                var obj = itemobjs.eq(cur);
                cur++;
                if(itemobjs.size()<cur){
                    $.dialog({id:'Load3722'}).close();
                    //请等待原注册商确认，失败的请按照错误提示重新提交。
                    var msg = "本次提交转入：成功 <span class='GreenColor'>" + intok + "</span>个，失败 <span class='redColor'>" + intbad + "</span>个。";
                    if(intok>0) msg+= "请等待原注册商确认后即可转入成功；";
                    if(intbad>0) msg+= "<br>失败的域名，请按照错误提示处理后再重试，若不清楚请联系客服。";
                  //  if(intok>0) msg+= "<br>最终转入结果我们将以邮件方式通知，<a href='/manager/domain/zhuanru.asp' target='_blank'>点这里返回管理</a>";
                    $.dialog({content: msg ,ok: function(){} ,title:'提交结果',max: false, min: false,icon: 'tips.gif'})
                    if(intbad>0){$("#btnresubmit").show()}
                    return false;
                }

                var punycode=obj.attr("punycode");
                var authcode=obj.attr("authcode");
                var proid = obj.attr("proid");

				console.log("punycode=>"+punycode+" ;authcode=>"+authcode+" ;proid=>"+proid)
                var strdata = "act=sub&1=" + urlencode(punycode)+ "&2="+opt_mbid + "&3=" + opt_chgdns // + "&2=" + urlencode(authcode) + "&3=" + opt_chgdns + "&4=" + opt_mbid + "&5=" + urlencode(opt_hkfree)+"&6="+ escape(mc_setcodeid);

                Dg3722.content('<div class="myloadbox">正在提交第<strong>'+cur+'</strong>个域名 <strong>'+punycode+'</strong></div>');
                obj.find("td[tag=status]").html("处理中...");
                obj.find("td[tag=message]").html("处理中...");

                $.ajax({type:'POST',url: window.location.pathname,data: strdata,error:function(xhr,txtstatus){ if(xhr.readyState!=0){
                    alert(xhr.responseText + "<br><font color=red>系统网络错误请联系管理员，点击确定继续</font>",function(){
                        obj.find("td[tag=status]").html("失败");
                        obj.find("td[tag=message]").html("系统网络错误 500");
                        diguisub(cur);
                    })
                }},success : function(xml){  
                        var J = JSON.parse(xml);
                        if(J.result=="200"){
                            intok ++;
                            J.result = "<span class='bgreen'>成功</span>";
                            obj.attr("needtry","");
                        }else{
                            intbad ++;
                            J.result = "<span class='bred'>失败</span>";
                        }
                        obj.find("td[tag=status]").html(J.result);
                        obj.find("td[tag=message]").html(J.msg);
                        if(J.msg.indexOf('<focusbutton/>')>-1){
                            obj.find("td[tag=message]").append("<input type='button' onclick='focussub(" + cur + ")' value='强制转移'>");
                        }
                        diguisub(cur);
                   
                },complete:function(obj){obj=null},
				error:function(a,b,c){				
				  alert(xml,function(){
                            obj.find("td[tag=status]").html("失败");
                            obj.find("td[tag=message]").html("系统繁忙 1001");
                            diguisub(cur);
                        })
				}
                })
            }

            function subneedtry(){
                var arr = [];
                $(".domitem").each(function(){
                    var tr=$(this);
                    if(tr.attr("needtry")=="1"){
                        arr.push (tr.attr("punycode") + " " + tr.attr("authcode"));
                    }
                })

                $("#frmresubmit").attr({"action":"/services/domain/transfer.asp","method":"post"}).html('<textarea name="i">' + arr.join("\r\n") + '</textarea>').get(0).submit();
            }


            // 创建自动完成框
            function createSelectAutocomplete() {
                var instanceId = 0;
                $('select.mbproid').each(function (event) {
                    var selectDom = $(this);
                    var appendDomArr=['<input type="text" class="common-input auto-complete-input"><i class="auto-complete-arrow"></i>'];
                    var data =[];
                    // 遍历select 获取对应的数据
                    appendDomArr.push('<span class="auto-complete-container"><ul>');
                    selectDom.find('option').each(function () {
                        var value = $(this).attr('value');
                        var desc = $(this).text();
                        data.push({
                            value:value,
                            desc:desc
                        });
                        appendDomArr.push('<li data-value="'+value+'">'+desc+'</li>');
                    });
                    appendDomArr.push('</ul></span>');

                    selectDom.wrap('<span class="pos-r"></span>');
                    selectDom.parent().append(appendDomArr.join(''));
                    selectDom.hide();

                    var input = selectDom.siblings('.auto-complete-input');
                    var autoCompleteContainer = selectDom.siblings('.auto-complete-container');
                    autoCompleteContainer.data('instanceId',instanceId++);
                    var arrowIcon = selectDom.siblings('.auto-complete-arrow');
                    input.add(arrowIcon).on('click',function (event) {
                        autoCompleteContainer.toggleClass('active');
                        event.stopPropagation();
                        $(document).trigger('CLICK_INPUT',autoCompleteContainer.data('instanceId'));
                        return false;
                    });
                    input.on('keyup',function () {
                        var value = $.trim($(this).val());
                        var matched = [];
                        for(var i=0,len=data.length;i<len;i++){
                            if(data[i].desc.indexOf(value)>=0){
                                matched.push(data[i]);
                            }
                        }
                        var matchedDomStr=[];
                        for(var i=0,len=matched.length;i<len;i++){
                            matchedDomStr.push('<li data-value="'+(matched[i].value)+'">'+(matched[i].desc)+'</li>');
                        }
                        autoCompleteContainer.find('ul').html(matchedDomStr);
                    });
                    $(document).on('CLICK_BODY',function () {
                        autoCompleteContainer.removeClass('active');
                    });
                    $(document).on('CLICK_INPUT',function (event,id) {
                        if(autoCompleteContainer.data('instanceId')!=id){
                            autoCompleteContainer.removeClass('active');
                        }
                    });
                    autoCompleteContainer.on('click','li',function (event) {
                        $(this).addClass('active').siblings('li').removeClass('active');
                        var value = $(this).attr('data-value');
                        var desc = $(this).text();
                        input.val(desc);
                        selectDom.val(value);
                        autoCompleteContainer.removeClass('active');
                        event.stopPropagation();
                        return false;
                    });
                    autoCompleteContainer.find('li:first').trigger('click');
                });
                $(document).on('click.autocomplete',function () {
                    $(document).trigger('CLICK_BODY');
                });
            }
            $(function(){
                $("#moneycodebtn").click(function(){
                    var mcobj=$("input[name='mc_hashcode']:hidden");
                    $.each(mcobj,function(i,e){
                        $(e).data("priceobj",$(e).parents(".domitem").find(".pricespan")[0]);
                    });
                    $.moneyCodeObj({
                        "mcobj":mcobj,
                        "allpriceobj":$("#allprice")[0],
                        "test":1
                    }).mcshowbox();
                });
                createSelectAutocomplete();

            });
            function urlencode(text){text=escape(text.toString()).replace(/\+/g,"%2B");var matches=text.match(/(%([0-9A-F]{2}))/gi);if (matches){for (var matchid=0;matchid<matches.length;matchid++){var code=matches[matchid].substring(1,3);if (parseInt(code,16)>=128){text=text.replace(matches[matchid],'%u00'+code)}}}text=text.replace('%25','%u0025');return text}

		</script> 
	

</div>
</div>
{#bottom.html}

 <script src="/jscripts/layui/layui.js"></script>
 <script type="text/javascript">
   $(function(){
        layui.use(['form','laydate','laypage','layer','table','upload'], function(){			
          layform = layui.form;
          laypage = layui.laypage;
          laydate = layui.laydate;
          layer=layui.layer;
          laytable = layui.table;    
          layupload=layui.upload;  
          
       domainaudit.getdomaintype.call(formtrans);

        });    
    });
</script>

</body>
</html>
